#frames list: [119, 119, 119, 119, 119]
Loading stat from data/data_ngrip_fixed/../stats.h5 ...
model #params: 443560
Randomly initialize the model's parameters
{'env': 'Gripper', 'stage': 'dy', 'pstep': 2, 'random_seed': 42, 'time_step': 119, 'dt': 0.016666666666666666, 'n_instance': 1, 'nf_relation': 150, 'nf_particle': 150, 'nf_pos': 150, 'nf_memory': 150, 'mem_nlayer': 2, 'nf_effect': 150, 'stdreg': 0, 'stdreg_weight': 0.0, 'matched_motion': 0, 'matched_motion_weight': 0.0, 'valid': 0, 'eval': 1, 'verbose_data': 0, 'verbose_model': 0, 'eps': 1e-06, 'outf_eval': '', 'controlf': '', 'outf_new': '', 'gripperf': '../simulator/plb/envs/gripper_fixed.yml', 'neighbor_radius': 0.05, 'gripper_extra_neighbor_radius': 0.015, 'neighbor_k': 20, 'shape_state_dim': 14, 'attr_dim': 3, 'state_dim': 3, 'relation_dim': 0, 'physics_param_range': (-5.0, -5.0), 'vis_width': 160, 'vis_height': 120, 'data_type': 'ngrip_fixed', 'gt_particles': 0, 'shape_aug': 1, 'loss_type': 'emd_chamfer_h', 'h_weight': 0.0, 'emd_weight': 0.9, 'chamfer_weight': 0.1, 'p_rigid': 1.0, 'n_his': 4, 'sequence_length': 6, 'n_rollout': 5, 'train_valid_ratio': 0.9, 'num_workers': 4, 'log_per_iter': 100, 'ckp_per_iter': 100, 'n_epoch': 20, 'beta1': 0.9, 'lr': 0.0001, 'optimizer': 'Adam', 'max_grad_norm': 1.0, 'batch_size': 4, 'gen_data': 0, 'gen_stat': 0, 'gen_vision': 0, 'resume': 0, 'resume_epoch': 0, 'resume_iter': 0, 'augment_ratio': 0.05, 'pyflex': 1, 'vis': 'plt', 'model_path': '', 'opt_algo': 'max', 'control_algo': 'fix', 'predict_horizon': 2, 'shooting_size': 200, 'shooting_batch_size': 4, 'reward_type': 'emd_chamfer_h', 'use_sim': 0, 'gt_action': 0, 'gt_state_goal': 0, 'subgoal': 0, 'correction': 0, 'n_grips': 3, 'debug': 0, 'shape_type': '', 'goal_shape_name': '', 'outf_control': '', 'eval_epoch': -1, 'eval_iter': -1, 'eval_set': 'train', 'algo': 'sac', 'env_name': 'gripper_fixed-v1', 'path': './tmp', 'seed': 0, 'num_steps': None, 'rllr': 0.1, 'optim': 'Adam', 'data_names': ['positions', 'shape_quats', 'scene_params'], 'dataf': 'data/data_ngrip_fixed', 'outf': 'dump/dump_ngrip_fixed/out_25-Jun-2022-14:53:02.222126', 'mean_p': array([0.50932539, 0.11348496, 0.49837578]), 'std_p': array([0.06474939, 0.04888084, 0.05906044]), 'mean_d': array([-0.00284736,  0.00286124, -0.00130389]), 'std_d': array([0.01755744, 0.01663332, 0.01677678])}

train epoch[0/20] iter[0/114] LR: 0.000100, loss: 0.039692 (0.029792), loss_raw: 0.07666536 (0.07650921)
std_cluster None

train epoch[0/20] iter[100/114] LR: 0.000100, loss: 0.040472 (0.028734), loss_raw: 0.07778419 (0.07584773)
std_cluster None
train epoch[0/20] Loss: 0.028712, Best valid: inf

train epoch[1/20] iter[0/114] LR: 0.000100, loss: 0.037883 (0.028472), loss_raw: 0.07552691 (0.07518040)
std_cluster None

train epoch[1/20] iter[100/114] LR: 0.000100, loss: 0.038493 (0.028634), loss_raw: 0.07541019 (0.07575800)
std_cluster None
train epoch[1/20] Loss: 0.028651, Best valid: inf

train epoch[2/20] iter[0/114] LR: 0.000100, loss: 0.038303 (0.028815), loss_raw: 0.07324939 (0.07452133)
std_cluster None

train epoch[2/20] iter[100/114] LR: 0.000100, loss: 0.035869 (0.028574), loss_raw: 0.07751667 (0.07572583)
std_cluster None
train epoch[2/20] Loss: 0.028636, Best valid: inf

train epoch[3/20] iter[0/114] LR: 0.000100, loss: 0.037771 (0.028263), loss_raw: 0.07535166 (0.07621864)
std_cluster None

train epoch[3/20] iter[100/114] LR: 0.000100, loss: 0.039225 (0.028600), loss_raw: 0.07570056 (0.07570787)
std_cluster None
train epoch[3/20] Loss: 0.028620, Best valid: inf

train epoch[4/20] iter[0/114] LR: 0.000100, loss: 0.039249 (0.029420), loss_raw: 0.07613729 (0.07666542)
std_cluster None

train epoch[4/20] iter[100/114] LR: 0.000100, loss: 0.035066 (0.028610), loss_raw: 0.07729325 (0.07578619)
std_cluster None
train epoch[4/20] Loss: 0.028585, Best valid: inf

train epoch[5/20] iter[0/114] LR: 0.000100, loss: 0.037269 (0.027713), loss_raw: 0.07599598 (0.07636051)
std_cluster None

train epoch[5/20] iter[100/114] LR: 0.000100, loss: 0.036516 (0.028555), loss_raw: 0.07672241 (0.07573379)
std_cluster None
train epoch[5/20] Loss: 0.028558, Best valid: inf

train epoch[6/20] iter[0/114] LR: 0.000100, loss: 0.039602 (0.029596), loss_raw: 0.07568045 (0.07568901)
std_cluster None

train epoch[6/20] iter[100/114] LR: 0.000100, loss: 0.036262 (0.028519), loss_raw: 0.07517273 (0.07571604)
std_cluster None
train epoch[6/20] Loss: 0.028544, Best valid: inf

train epoch[7/20] iter[0/114] LR: 0.000100, loss: 0.036853 (0.027477), loss_raw: 0.07445687 (0.07530890)
std_cluster None

train epoch[7/20] iter[100/114] LR: 0.000100, loss: 0.038774 (0.028530), loss_raw: 0.07505015 (0.07569321)
std_cluster None
train epoch[7/20] Loss: 0.028530, Best valid: inf

train epoch[8/20] iter[0/114] LR: 0.000100, loss: 0.038278 (0.028522), loss_raw: 0.07463028 (0.07575265)
std_cluster None

train epoch[8/20] iter[100/114] LR: 0.000100, loss: 0.040146 (0.028498), loss_raw: 0.07790057 (0.07569374)
std_cluster None
train epoch[8/20] Loss: 0.028525, Best valid: inf

train epoch[9/20] iter[0/114] LR: 0.000100, loss: 0.038199 (0.028586), loss_raw: 0.07925764 (0.07863830)
std_cluster None

train epoch[9/20] iter[100/114] LR: 0.000100, loss: 0.037726 (0.028477), loss_raw: 0.07735079 (0.07573014)
std_cluster None
train epoch[9/20] Loss: 0.028517, Best valid: inf

train epoch[10/20] iter[0/114] LR: 0.000100, loss: 0.038225 (0.028638), loss_raw: 0.07549579 (0.07585369)
std_cluster None

train epoch[10/20] iter[100/114] LR: 0.000100, loss: 0.038728 (0.028585), loss_raw: 0.07598118 (0.07568058)
std_cluster None
train epoch[10/20] Loss: 0.028507, Best valid: inf

train epoch[11/20] iter[0/114] LR: 0.000100, loss: 0.036832 (0.027329), loss_raw: 0.07702310 (0.07645686)
std_cluster None

train epoch[11/20] iter[100/114] LR: 0.000100, loss: 0.034783 (0.028536), loss_raw: 0.07630697 (0.07556445)
std_cluster None
train epoch[11/20] Loss: 0.028497, Best valid: inf

train epoch[12/20] iter[0/114] LR: 0.000100, loss: 0.036283 (0.027036), loss_raw: 0.07429630 (0.07485304)
std_cluster None

train epoch[12/20] iter[100/114] LR: 0.000100, loss: 0.036740 (0.028504), loss_raw: 0.07714257 (0.07573179)
std_cluster None
train epoch[12/20] Loss: 0.028489, Best valid: inf

train epoch[13/20] iter[0/114] LR: 0.000100, loss: 0.039614 (0.029610), loss_raw: 0.07613885 (0.07650157)
std_cluster None

train epoch[13/20] iter[100/114] LR: 0.000100, loss: 0.037554 (0.028463), loss_raw: 0.07777304 (0.07567885)
std_cluster None
train epoch[13/20] Loss: 0.028485, Best valid: inf

train epoch[14/20] iter[0/114] LR: 0.000100, loss: 0.039553 (0.029678), loss_raw: 0.07355861 (0.07499202)
std_cluster None

train epoch[14/20] iter[100/114] LR: 0.000100, loss: 0.040050 (0.028473), loss_raw: 0.07574105 (0.07573435)
std_cluster None
train epoch[14/20] Loss: 0.028477, Best valid: inf

train epoch[15/20] iter[0/114] LR: 0.000100, loss: 0.037666 (0.028286), loss_raw: 0.07258051 (0.07334272)
std_cluster None

train epoch[15/20] iter[100/114] LR: 0.000100, loss: 0.039958 (0.028391), loss_raw: 0.07606817 (0.07566439)
std_cluster None
train epoch[15/20] Loss: 0.028473, Best valid: inf

train epoch[16/20] iter[0/114] LR: 0.000100, loss: 0.039466 (0.029654), loss_raw: 0.07474148 (0.07540338)
std_cluster None

train epoch[16/20] iter[100/114] LR: 0.000100, loss: 0.037579 (0.028477), loss_raw: 0.07572032 (0.07568077)
std_cluster None
train epoch[16/20] Loss: 0.028469, Best valid: inf

train epoch[17/20] iter[0/114] LR: 0.000100, loss: 0.037216 (0.027850), loss_raw: 0.07558813 (0.07567397)
std_cluster None

train epoch[17/20] iter[100/114] LR: 0.000100, loss: 0.035481 (0.028430), loss_raw: 0.07316381 (0.07566086)
std_cluster None
train epoch[17/20] Loss: 0.028462, Best valid: inf

train epoch[18/20] iter[0/114] LR: 0.000100, loss: 0.038398 (0.028933), loss_raw: 0.07408737 (0.07480248)
std_cluster None

train epoch[18/20] iter[100/114] LR: 0.000100, loss: 0.035318 (0.028451), loss_raw: 0.07584228 (0.07565466)
std_cluster None
train epoch[18/20] Loss: 0.028459, Best valid: inf

train epoch[19/20] iter[0/114] LR: 0.000100, loss: 0.040376 (0.030246), loss_raw: 0.07565477 (0.07572088)
std_cluster None

train epoch[19/20] iter[100/114] LR: 0.000100, loss: 0.034022 (0.028441), loss_raw: 0.07715492 (0.07562935)
std_cluster None
train epoch[19/20] Loss: 0.028455, Best valid: inf
model_kp #params: 443560
Loading network from dump/dump_ngrip_fixed/out_25-Jun-2022-14:53:02.222126/net_epoch_19_iter_34.pth
Rollout 0 / 5
Rollout 1 / 5
Rollout 2 / 5
Rollout 3 / 5
Rollout 4 / 5

Average emd loss at last frame: 0.051364530622959134 (+- 0.004351663613510929)
Average chamfer loss at last frame: 0.0467090368270874 (+- 0.004961382970013935)
Average hausdorff loss at last frame: 0.1406076267361641 (+- 0.023713155910542724)

Average emd loss over episodes: 0.032228556515082066 (+- 0.010308233333511694)
Average chamfer loss over episodes: 0.036946348748777225 (+- 0.004847012806270253)
Average hausdorff loss over episodes: 0.09203345158177874 (+- 0.026222274630663144)
